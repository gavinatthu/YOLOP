Namespace(conf_thres=0.001, dataDir='', iou_thres=0.6, local_rank=-1, logDir='runs/', modelDir='', prevModelDir='', sync_bn=False)
AUTO_RESUME: False
CUDNN:
  BENCHMARK: True
  DETERMINISTIC: False
  ENABLED: True
DATASET:
  COLOR_RGB: False
  DATAROOT: /data1/BDD100K/bdd100k/images/100k
  DATASET: BddDataset
  DATA_FORMAT: jpg
  FLIP: True
  HSV_H: 0.015
  HSV_S: 0.7
  HSV_V: 0.4
  LABELROOT: /data1/BDD100K/YOLOP/det_annotations
  LANEROOT: /data1/BDD100K/YOLOP/bdd_lane_gt
  MASKROOT: /data1/BDD100K/YOLOP/bdd_seg_gt
  ORG_IMG_SIZE: [720, 1280]
  ROT_FACTOR: 10
  SCALE_FACTOR: 0.25
  SELECT_DATA: False
  SHEAR: 0.0
  TEST_SET: val
  TRAIN_SET: train
  TRANSLATE: 0.1
DEBUG: False
GPUS: (0, 1, 2, 3)
LOG_DIR: runs/
LOSS:
  BOX_GAIN: 0.05
  CLS_GAIN: 0.5
  CLS_POS_WEIGHT: 1.0
  DA_SEG_GAIN: 0.2
  FL_GAMMA: 0.0
  LL_IOU_GAIN: 0.2
  LL_SEG_GAIN: 0.2
  LOSS_NAME: 
  MULTI_HEAD_LAMBDA: None
  OBJ_GAIN: 1.0
  OBJ_POS_WEIGHT: 1.0
  SEG_POS_WEIGHT: 1.0
MODEL:
  EXTRA:
    
  HEADS_NAME: ['']
  IMAGE_SIZE: [640, 640]
  NAME: 
  PRETRAINED: 
  PRETRAINED_DET: 
  STRU_WITHSHARE: False
NEED_AUTOANCHOR: False
PIN_MEMORY: False
PRINT_FREQ: 20
TEST:
  BATCH_SIZE_PER_GPU: 24
  MODEL_FILE: 
  NMS_CONF_THRESHOLD: 0.001
  NMS_IOU_THRESHOLD: 0.6
  PLOTS: True
  SAVE_JSON: False
  SAVE_TXT: False
TRAIN:
  ANCHOR_THRESHOLD: 4.0
  BATCH_SIZE_PER_GPU: 6
  BEGIN_EPOCH: 0
  DET_ONLY: False
  DRIVABLE_ONLY: False
  ENC_DET_ONLY: False
  ENC_SEG_ONLY: False
  END_EPOCH: 240
  GAMMA1: 0.99
  GAMMA2: 0.0
  IOU_THRESHOLD: 0.2
  LANE_ONLY: False
  LR0: 0.001
  LRF: 0.2
  MOMENTUM: 0.937
  NESTEROV: True
  OPTIMIZER: adam
  PLOT: True
  SEG_ONLY: False
  SHUFFLE: True
  VAL_FREQ: 1
  WARMUP_BIASE_LR: 0.1
  WARMUP_EPOCHS: 3.0
  WARMUP_MOMENTUM: 0.8
  WD: 0.0005
WORKERS: 8
num_seg_class: 2
Using torch 1.10.0+cu113 CUDA:0 (NVIDIA GeForce RTX 3090, 24268MB)
                         CUDA:1 (NVIDIA GeForce RTX 3090, 24268MB)
                         CUDA:2 (NVIDIA GeForce RTX 3090, 24268MB)
                         CUDA:3 (NVIDIA GeForce RTX 3090, 24268MB)

=> creating runs/BddDataset/_2021-11-30-14-19
begin to bulid up model...
load model to device
begin to load data
building database...
  0%|          | 0/70000 [00:00<?, ?it/s]  1%|          | 416/70000 [00:00<00:16, 4155.07it/s]  1%|          | 839/70000 [00:00<00:16, 4197.77it/s]  2%|▏         | 1266/70000 [00:00<00:16, 4227.90it/s]  2%|▏         | 1689/70000 [00:00<00:16, 4187.27it/s]  3%|▎         | 2108/70000 [00:00<00:16, 4165.40it/s]  4%|▎         | 2525/70000 [00:00<00:16, 4135.61it/s]  4%|▍         | 2944/70000 [00:00<00:16, 4152.87it/s]  5%|▍         | 3360/70000 [00:00<00:16, 4080.74it/s]  5%|▌         | 3769/70000 [00:00<00:16, 4071.72it/s]  6%|▌         | 4185/70000 [00:01<00:16, 4096.04it/s]  7%|▋         | 4611/70000 [00:01<00:15, 4143.92it/s]  7%|▋         | 5026/70000 [00:01<00:15, 4143.63it/s]  8%|▊         | 5454/70000 [00:01<00:15, 4184.45it/s]  8%|▊         | 5873/70000 [00:01<00:15, 4134.10it/s]  9%|▉         | 6287/70000 [00:01<00:15, 4010.41it/s] 10%|▉         | 6693/70000 [00:01<00:15, 4020.66it/s] 10%|█         | 7112/70000 [00:01<00:15, 4068.63it/s] 11%|█         | 7541/70000 [00:01<00:15, 4133.07it/s] 11%|█▏        | 7960/70000 [00:01<00:14, 4149.86it/s] 12%|█▏        | 8387/70000 [00:02<00:14, 4184.80it/s] 13%|█▎        | 8807/70000 [00:02<00:14, 4187.67it/s] 13%|█▎        | 9232/70000 [00:02<00:14, 4204.10it/s] 14%|█▍        | 9653/70000 [00:02<00:14, 4137.91it/s] 14%|█▍        | 10072/70000 [00:02<00:14, 4153.09it/s] 15%|█▌        | 10500/70000 [00:02<00:14, 4189.78it/s] 16%|█▌        | 10925/70000 [00:02<00:14, 4205.02it/s] 16%|█▌        | 11346/70000 [00:02<00:13, 4201.04it/s] 17%|█▋        | 11767/70000 [00:02<00:13, 4176.78it/s] 17%|█▋        | 12194/70000 [00:02<00:13, 4204.00it/s] 18%|█▊        | 12615/70000 [00:03<00:13, 4188.68it/s] 19%|█▊        | 13038/70000 [00:03<00:13, 4200.32it/s] 19%|█▉        | 13459/70000 [00:03<00:13, 4185.06it/s] 20%|█▉        | 13879/70000 [00:03<00:13, 4187.74it/s] 20%|██        | 14298/70000 [00:03<00:13, 4179.66it/s] 21%|██        | 14716/70000 [00:03<00:13, 4167.34it/s] 22%|██▏       | 15138/70000 [00:03<00:13, 4181.90it/s] 22%|██▏       | 15557/70000 [00:03<00:13, 4118.93it/s] 23%|██▎       | 15977/70000 [00:03<00:13, 4141.96it/s] 23%|██▎       | 16401/70000 [00:03<00:12, 4169.25it/s] 24%|██▍       | 16819/70000 [00:04<00:12, 4157.79it/s] 25%|██▍       | 17236/70000 [00:04<00:12, 4158.13it/s] 25%|██▌       | 17652/70000 [00:04<00:12, 4142.47it/s] 26%|██▌       | 18072/70000 [00:04<00:12, 4157.48it/s] 26%|██▋       | 18488/70000 [00:04<00:12, 4151.87it/s] 27%|██▋       | 18922/70000 [00:04<00:12, 4207.86it/s] 28%|██▊       | 19343/70000 [00:04<00:12, 4191.71it/s] 28%|██▊       | 19774/70000 [00:04<00:11, 4188.67it/s] 29%|██▉       | 20193/70000 [00:04<00:13, 3674.91it/s] 29%|██▉       | 20612/70000 [00:05<00:12, 3812.59it/s] 30%|███       | 21039/70000 [00:05<00:12, 3938.28it/s] 31%|███       | 21443/70000 [00:05<00:12, 3966.30it/s] 31%|███       | 21860/70000 [00:05<00:11, 4023.38it/s] 32%|███▏      | 22278/70000 [00:05<00:11, 4067.43it/s] 32%|███▏      | 22702/70000 [00:05<00:11, 4116.95it/s] 33%|███▎      | 23121/70000 [00:05<00:11, 4137.36it/s] 34%|███▎      | 23537/70000 [00:05<00:11, 4132.52it/s] 34%|███▍      | 23952/70000 [00:05<00:11, 4117.29it/s] 35%|███▍      | 24366/70000 [00:05<00:11, 4120.86it/s] 35%|███▌      | 24784/70000 [00:06<00:10, 4137.32it/s] 36%|███▌      | 25206/70000 [00:06<00:10, 4159.04it/s] 37%|███▋      | 25623/70000 [00:06<00:10, 4159.91it/s] 37%|███▋      | 26044/70000 [00:06<00:10, 4173.40it/s] 38%|███▊      | 26466/70000 [00:06<00:10, 4184.04it/s] 38%|███▊      | 26893/70000 [00:06<00:10, 4206.07it/s] 39%|███▉      | 27320/70000 [00:06<00:10, 4222.69it/s] 40%|███▉      | 27743/70000 [00:06<00:10, 4204.66it/s] 40%|████      | 28164/70000 [00:06<00:10, 4161.02it/s] 41%|████      | 28594/70000 [00:06<00:09, 4199.97it/s] 41%|████▏     | 29015/70000 [00:07<00:09, 4193.29it/s] 42%|████▏     | 29435/70000 [00:07<00:09, 4190.17it/s] 43%|████▎     | 29855/70000 [00:07<00:09, 4074.92it/s] 43%|████▎     | 30264/70000 [00:07<00:09, 4039.44it/s] 44%|████▍     | 30670/70000 [00:07<00:09, 4045.32it/s] 44%|████▍     | 31083/70000 [00:07<00:09, 4069.22it/s] 45%|████▌     | 31501/70000 [00:07<00:09, 4100.11it/s] 46%|████▌     | 31930/70000 [00:07<00:09, 4155.08it/s] 46%|████▌     | 32362/70000 [00:07<00:08, 4202.29it/s] 47%|████▋     | 32783/70000 [00:07<00:08, 4196.35it/s] 47%|████▋     | 33203/70000 [00:08<00:08, 4160.56it/s] 48%|████▊     | 33629/70000 [00:08<00:08, 4188.45it/s] 49%|████▊     | 34048/70000 [00:08<00:08, 4135.52it/s] 49%|████▉     | 34464/70000 [00:08<00:08, 4142.29it/s] 50%|████▉     | 34882/70000 [00:08<00:08, 4149.89it/s] 50%|█████     | 35302/70000 [00:08<00:08, 4163.45it/s] 51%|█████     | 35719/70000 [00:08<00:08, 4152.34it/s] 52%|█████▏    | 36156/70000 [00:08<00:08, 4215.73it/s] 52%|█████▏    | 36578/70000 [00:08<00:07, 4200.90it/s] 53%|█████▎    | 37003/70000 [00:08<00:07, 4215.22it/s] 53%|█████▎    | 37426/70000 [00:09<00:07, 4219.39it/s] 54%|█████▍    | 37855/70000 [00:09<00:07, 4239.34it/s] 55%|█████▍    | 38279/70000 [00:09<00:07, 4224.31it/s] 55%|█████▌    | 38702/70000 [00:09<00:07, 4222.74it/s] 56%|█████▌    | 39131/70000 [00:09<00:07, 4240.36it/s] 57%|█████▋    | 39556/70000 [00:09<00:07, 4240.38it/s] 57%|█████▋    | 39983/70000 [00:09<00:07, 4248.18it/s] 58%|█████▊    | 40408/70000 [00:09<00:07, 4149.45it/s] 58%|█████▊    | 40824/70000 [00:09<00:07, 3844.95it/s] 59%|█████▉    | 41235/70000 [00:09<00:07, 3918.02it/s] 60%|█████▉    | 41653/70000 [00:10<00:07, 3991.19it/s] 60%|██████    | 42075/70000 [00:10<00:06, 4057.30it/s] 61%|██████    | 42489/70000 [00:10<00:06, 4080.13it/s] 61%|██████▏   | 42921/70000 [00:10<00:06, 4149.51it/s] 62%|██████▏   | 43339/70000 [00:10<00:06, 4158.11it/s] 63%|██████▎   | 43769/70000 [00:10<00:06, 4198.63it/s] 63%|██████▎   | 44191/70000 [00:10<00:06, 4203.29it/s] 64%|██████▎   | 44612/70000 [00:10<00:06, 4179.66it/s] 64%|██████▍   | 45031/70000 [00:10<00:06, 4152.07it/s] 65%|██████▍   | 45452/70000 [00:10<00:05, 4168.63it/s] 66%|██████▌   | 45878/70000 [00:11<00:05, 4193.84it/s] 66%|██████▌   | 46298/70000 [00:11<00:05, 4151.22it/s] 67%|██████▋   | 46716/70000 [00:11<00:05, 4159.04it/s] 67%|██████▋   | 47133/70000 [00:11<00:05, 4140.29it/s] 68%|██████▊   | 47558/70000 [00:11<00:05, 4171.83it/s] 69%|██████▊   | 47981/70000 [00:11<00:05, 4186.75it/s] 69%|██████▉   | 48400/70000 [00:11<00:05, 4156.50it/s] 70%|██████▉   | 48828/70000 [00:11<00:05, 4192.19it/s] 70%|███████   | 49252/70000 [00:11<00:04, 4203.62it/s] 71%|███████   | 49673/70000 [00:11<00:04, 4176.28it/s] 72%|███████▏  | 50093/70000 [00:12<00:04, 4182.26it/s] 72%|███████▏  | 50513/70000 [00:12<00:04, 4184.96it/s] 73%|███████▎  | 50932/70000 [00:12<00:04, 4185.08it/s] 73%|███████▎  | 51361/70000 [00:12<00:04, 4216.10it/s] 74%|███████▍  | 51784/70000 [00:12<00:04, 4217.06it/s] 75%|███████▍  | 52206/70000 [00:12<00:04, 4174.76it/s] 75%|███████▌  | 52624/70000 [00:12<00:04, 4140.94it/s] 76%|███████▌  | 53039/70000 [00:12<00:04, 4140.87it/s] 76%|███████▋  | 53461/70000 [00:12<00:03, 4162.62it/s] 77%|███████▋  | 53878/70000 [00:13<00:03, 4102.90it/s] 78%|███████▊  | 54289/70000 [00:13<00:03, 4018.74it/s] 78%|███████▊  | 54706/70000 [00:13<00:03, 4061.06it/s] 79%|███████▊  | 55120/70000 [00:13<00:03, 4082.77it/s] 79%|███████▉  | 55544/70000 [00:13<00:03, 4126.82it/s] 80%|███████▉  | 55967/70000 [00:13<00:03, 4156.69it/s] 81%|████████  | 56386/70000 [00:13<00:03, 4165.49it/s] 81%|████████  | 56818/70000 [00:13<00:03, 4210.54it/s] 82%|████████▏ | 57240/70000 [00:13<00:03, 4197.40it/s] 82%|████████▏ | 57660/70000 [00:13<00:02, 4181.64it/s] 83%|████████▎ | 58088/70000 [00:14<00:02, 4208.15it/s] 84%|████████▎ | 58509/70000 [00:14<00:02, 4162.40it/s] 84%|████████▍ | 58935/70000 [00:14<00:02, 4190.60it/s] 85%|████████▍ | 59355/70000 [00:14<00:02, 4191.79it/s] 85%|████████▌ | 59775/70000 [00:14<00:02, 4181.58it/s] 86%|████████▌ | 60206/70000 [00:14<00:02, 4216.77it/s] 87%|████████▋ | 60628/70000 [00:14<00:02, 4171.56it/s] 87%|████████▋ | 61053/70000 [00:14<00:02, 4192.11it/s] 88%|████████▊ | 61473/70000 [00:14<00:02, 3824.82it/s] 88%|████████▊ | 61896/70000 [00:14<00:02, 3936.25it/s] 89%|████████▉ | 62307/70000 [00:15<00:01, 3985.67it/s] 90%|████████▉ | 62710/70000 [00:15<00:01, 3996.54it/s] 90%|█████████ | 63131/70000 [00:15<00:01, 4056.90it/s] 91%|█████████ | 63551/70000 [00:15<00:01, 4096.34it/s] 91%|█████████▏| 63981/70000 [00:15<00:01, 4156.53it/s] 92%|█████████▏| 64398/70000 [00:15<00:01, 4118.91it/s] 93%|█████████▎| 64814/70000 [00:15<00:01, 4129.19it/s] 93%|█████████▎| 65233/70000 [00:15<00:01, 4143.64it/s] 94%|█████████▍| 65652/70000 [00:15<00:01, 4154.78it/s] 94%|█████████▍| 66080/70000 [00:15<00:00, 4190.81it/s] 95%|█████████▌| 66506/70000 [00:16<00:00, 4208.27it/s] 96%|█████████▌| 66935/70000 [00:16<00:00, 4232.65it/s] 96%|█████████▌| 67359/70000 [00:16<00:00, 4205.29it/s] 97%|█████████▋| 67780/70000 [00:16<00:00, 4190.44it/s] 97%|█████████▋| 68213/70000 [00:16<00:00, 4231.06it/s] 98%|█████████▊| 68637/70000 [00:16<00:00, 4181.72it/s] 99%|█████████▊| 69059/70000 [00:16<00:00, 4191.24it/s] 99%|█████████▉| 69481/70000 [00:16<00:00, 4197.82it/s]100%|█████████▉| 69901/70000 [00:16<00:00, 4187.91it/s]100%|██████████| 70000/70000 [00:16<00:00, 4142.98it/s]
database build finish
building database...
  0%|          | 0/10000 [00:00<?, ?it/s]  4%|▍         | 412/10000 [00:00<00:02, 4114.00it/s]  8%|▊         | 824/10000 [00:00<00:02, 4091.71it/s] 12%|█▏        | 1238/10000 [00:00<00:02, 4111.24it/s] 17%|█▋        | 1652/10000 [00:00<00:02, 4119.90it/s] 21%|██        | 2074/10000 [00:00<00:01, 4153.75it/s] 25%|██▌       | 2503/10000 [00:00<00:01, 4197.31it/s] 29%|██▉       | 2928/10000 [00:00<00:01, 4213.32it/s] 34%|███▎      | 3350/10000 [00:00<00:01, 4198.29it/s] 38%|███▊      | 3776/10000 [00:00<00:01, 4216.78it/s] 42%|████▏     | 4198/10000 [00:01<00:01, 4189.28it/s] 46%|████▋     | 4629/10000 [00:01<00:01, 4225.74it/s] 51%|█████     | 5059/10000 [00:01<00:01, 4247.97it/s] 55%|█████▍    | 5484/10000 [00:01<00:01, 4246.39it/s] 59%|█████▉    | 5909/10000 [00:01<00:00, 4243.44it/s] 63%|██████▎   | 6334/10000 [00:01<00:00, 4197.28it/s] 68%|██████▊   | 6754/10000 [00:01<00:00, 4197.32it/s] 72%|███████▏  | 7174/10000 [00:01<00:00, 4189.94it/s] 76%|███████▌  | 7594/10000 [00:01<00:00, 4137.60it/s] 80%|████████  | 8008/10000 [00:01<00:00, 4024.63it/s] 84%|████████▍ | 8412/10000 [00:02<00:00, 4017.66it/s] 88%|████████▊ | 8840/10000 [00:02<00:00, 4091.21it/s] 93%|█████████▎| 9259/10000 [00:02<00:00, 4119.06it/s] 97%|█████████▋| 9685/10000 [00:02<00:00, 4158.22it/s]100%|██████████| 10000/10000 [00:02<00:00, 4164.85it/s]
anchors loaded successfully
database build finish
load data finished
=> start training...
Epoch: [1][0/2917]	Time 33.475s (33.475s)	Speed 0.7 samples/s	Data 3.955s (3.955s)	Loss 0.66762 (0.66762)
Epoch: [1][20/2917]	Time 81.913s (57.998s)	Speed 0.3 samples/s	Data 79.690s (54.307s)	Loss 0.66621 (0.66632)
Epoch: [1][40/2917]	Time 126.751s (81.125s)	Speed 0.2 samples/s	Data 124.406s (78.151s)	Loss 0.66809 (0.66659)
Epoch: [1][60/2917]	Time 171.351s (103.761s)	Speed 0.1 samples/s	Data 169.180s (101.039s)	Loss 0.67170 (0.66689)
Epoch: [1][80/2917]	Time 214.602s (126.074s)	Speed 0.1 samples/s	Data 212.509s (123.495s)	Loss 0.66862 (0.66693)
